<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="css/Create_Flight.css"/>
        <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.js"></script>
        <title>Create flight</title>
    </head>
<script>
$(function(){
var log=sessionStorage.getItem("user");
if(log!=null){
	$('#login').hide();
}
console.log(log);
});
</script>
    <body>
       <header>
    		<nav class="navbar navbar-light" style="background-color: #FFA500;">
  				<a class="navbar-brand" href="index.html">Kechache Airport</a>
  				<p id='login'><a href="login.html">Log In</a>/<a href="registration.html">Sign Up</a></p>
  				<form class="form-inline">
    				<input class="form-control mr-sm-2" type="search" placeholder="Ville de dÃ©part..." aria-label="Search"
    				onclick="location.replace('search.html')">
    				<button class="btn btn-warning" type="submit">Search</button>
  				</form>
			</nav>
		</header>
        <section>
            <form>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="departure">Departure</label>
                        <input type="text" class="form-control" id="departure"  placeholder="Paris"> 
                    </div>
                    <div class="form-group col-md-6">
                        <label for="arrival">Arrival :</label>
                        <input type="text" class="form-control" id="arrival"  placeholder="Bordeaux"> 	
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label for="price">Price :</label>
                        <input type="number" class="form-control" id="price" placeholder="60"> 	
                    </div>
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="form-group col-md-4">
                        <label for="places">Available seats :</label>
                        <input type="number" class="form-control" id="places"  placeholder="8"> 	
                    </div>
                    <div class="form-group col-md-4">
                        <label for="duration">Duration :</label>
                        <input type="time" class="form-control" id="duration"  placeholder="1:30"> 
                    </div>
                </div>			
                <label for="description">Description</label><br />
                <textarea name="description" id="description" rows="10" cols="60"></textarea>
                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input is-invalid" type="checkbox" value="" id="invalidCheck" required>
                        <label class="form-check-label" for="invalidCheck">
                            Agree to terms and conditions
                        </label>
                        <div class="invalid-feedback">
                            You must agree before submitting.
                        </div>
                    </div>
                </div>
                <button class="btn btn-wanted" id="submitf" type="button">Create Flight</button>   		
            </form>
        </section>
    </body>
    <script>
    $('#submitf').click(function() {
    	var n1=Math.ceil(Math.random()*100)+Math.ceil(Math.random()*100);
    	var n2=Math.ceil(Math.random()*100)+Math.ceil(Math.random()*100)+Math.ceil(Math.random()*100);
    	var n3=Math.ceil(Math.random()*100);
		var rand_id="GG"+(n1*n2)%300+""+n3;
		var user_id=sessionStorage.getItem("user");
    	var newFlight = {
    		id:rand_id,
    		pilotId:user_id,
    		seat: $('#places').val(),
    		passengerId:null,
    		departure: $('#departure').val(),
    		arrival: $('#arrival').val(),
    		date:"2020-09-01",
    		time:null,
    		duration: $('#duration').val(),
    		price: $('#price').val(),
    		info:$('#description').val()
    	}
    	console.log(newFlight);
    	$.ajax({
    		url: "/ws/flight/add",
    		type: 'put',
    		dataType: 'json',
    		contentType: 'application/json',
    		data: JSON.stringify(newFlight),
    	
    		success: function(data) {
				alert("successful!");
				location.replace("testp.html");
    		}

    	})
    })
    </script>
</html>


